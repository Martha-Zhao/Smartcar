clc;
clear;
pic = imread('dig.gif'); %??????
figure(1);
imshow (pic)
title("original picture") %??????

%%  Binarization    ???
pic_bin = pic;  
pic_tem = pic;
for i = 1:size(pic,1)
    for j = 1:size(pic,2)
        if pic(i,j) > 100
            pic_bin(i,j) = 1;  %%?????????
            pic_tem(i,j) = 255; %%????
        else
            pic_bin(i,j) = 0;
            pic_tem(i,j) = 0;
        end
    end
end

% figure(2);
% imshow(pic_tem)
% title("Binarization")

%%  Cut    ??
pic_sum_collon = sum(pic_bin,2);%??????
pic_sum_row = sum(pic_bin);     %??????
% figure(3);
% plot(pic_sum_collon,'r');
% title("sum_collon")
% hold on;
% plot(pic_sum_row,'b')
num_collon = 0;  %?????
num_row    = 0;  %?????
loc        = zeros(20,2);  %????????????????????
for i = 1:size(pic_sum_collon,1)-1  %???
    if (pic_sum_collon(i)<100) && (pic_sum_collon(i+1)>500)  %????
        num_collon = num_collon + 1; %???????????
        loc(num_collon,1) = i; %???????
    end
    if pic_sum_collon(i) >500  %????????
       loc(num_collon+1,1) = i; %??????
    end
    if (pic_sum_row(i)==0) && (pic_sum_row(i+1)>500)  %?????
        num_row = num_row +1; %???????????
        loc(num_row,2) = i;  %?????
    end
    if pic_sum_row(i) > 500  %????????
       loc(num_row+1,2) = i;  %????????
    end
end
num_collon = num_collon+1;  %?????
num_row    = num_row+1;     %?????

for i = 1:num_collon  %?????
    eval(['pic_sub',num2str(i),'=pic(loc(i,1)+1:loc(i+1,1)-2,loc(1,2)+1:loc(2,2)-2);']);
end

figure(4);  %??????
for i = 1:4
    subplot(2,2,i);
    eval(['imshow(','pic_sub',num2str(i),')']);
end
title("pic sub")

%% ??


